(()=>{var k=["youtu.be","youtube-nocookie.com","youtube.ae","youtube.al","youtube.am","youtube.at","youtube.az","youtube.ba","youtube.be","youtube.bg","youtube.bh","youtube.bo","youtube.by","youtube.ca","youtube.cat","youtube.ch","youtube.cl","youtube.co","youtube.co.ae","youtube.co.at","youtube.co.cr","youtube.co.hu","youtube.co.id","youtube.co.il","youtube.co.in","youtube.co.jp","youtube.co.ke","youtube.co.kr","youtube.co.ma","youtube.co.nz","youtube.co.th","youtube.co.tz","youtube.co.ug","youtube.co.uk","youtube.co.ve","youtube.co.za","youtube.co.zw","youtube.com","youtube.com.ar","youtube.com.au","youtube.com.az","youtube.com.bd","youtube.com.bh","youtube.com.bo","youtube.com.br","youtube.com.by","youtube.com.co","youtube.com.do","youtube.com.ec","youtube.com.ee","youtube.com.eg","youtube.com.es","youtube.com.gh","youtube.com.gr","youtube.com.gt","youtube.com.hk","youtube.com.hn","youtube.com.hr","youtube.com.jm","youtube.com.jo","youtube.com.kw","youtube.com.lb","youtube.com.lv","youtube.com.ly","youtube.com.mk","youtube.com.mt","youtube.com.mx","youtube.com.my","youtube.com.ng","youtube.com.ni","youtube.com.om","youtube.com.pa","youtube.com.pe","youtube.com.ph","youtube.com.pk","youtube.com.pt","youtube.com.py","youtube.com.qa","youtube.com.ro","youtube.com.sa","youtube.com.sg","youtube.com.sv","youtube.com.tn","youtube.com.tr","youtube.com.tw","youtube.com.ua","youtube.com.uy","youtube.com.ve","youtube.cr","youtube.cz","youtube.de","youtube.dk","youtube.ee","youtube.es","youtube.fi","youtube.fr","youtube.ge","youtube.gr","youtube.gt","youtube.hk","youtube.hr","youtube.hu","youtube.ie","youtube.in","youtube.iq","youtube.is","youtube.it","youtube.jo","youtube.jp","youtube.kr","youtube.kz","youtube.la","youtube.lk","youtube.lt","youtube.lu","youtube.lv","youtube.ly","youtube.ma","youtube.md","youtube.me","youtube.mk","youtube.mn","youtube.mx","youtube.my","youtube.ng","youtube.ni","youtube.nl","youtube.no","youtube.pa","youtube.pe","youtube.ph","youtube.pk","youtube.pl","youtube.pr","youtube.pt","youtube.qa","youtube.ro","youtube.rs","youtube.ru","youtube.sa","youtube.se","youtube.sg","youtube.si","youtube.sk","youtube.sn","youtube.soy","youtube.sv","youtube.tn","youtube.tv","youtube.ua","youtube.ug","youtube.uy","youtube.vn","youtubeeducation.com","youtubefanfest.com","youtubegaming.com","youtubego.co.id","youtubego.co.in","youtubego.com","youtubego.com.br","youtubego.id","youtubego.in","youtubekids.com","youtubemobilesupport.com","yt.be"],Y=new Set(k);function I(p){let i=p.toLowerCase();if(Y.has(i))return!0;for(let o of k)if(i.endsWith(`.${o}`))return!0;return!1}var s=document.getElementById("rulesBody"),E=document.getElementById("status"),M=document.getElementById("save"),R=document.getElementById("addRule"),x=document.getElementById("newType"),v=document.getElementById("newValue"),T=document.getElementById("newSpeed"),H=document.getElementById("editor"),S=document.getElementById("notYoutube");if(!s||!E||!M||!R||!x||!v||!T||!H||!S)console.warn("TooMuchYouTube popup: missing required elements.");else{let C=function(e){if(!e)return!1;try{let t=new URL(e);return I(t.hostname)}catch{return!1}},N=function(e){H.classList.toggle("hidden",!e),S.classList.toggle("hidden",e)},w=function(){chrome.tabs?.query&&chrome.tabs.query({active:!0,currentWindow:!0},e=>{let t=e&&e[0]?e[0]:null,u=t?.url||t?.pendingUrl||"";N(C(u))})},L=function(e){E.textContent=e,e&&setTimeout(()=>{E.textContent=""},1500)},l=function(){if(s.innerHTML="",o.length===0){let e=document.createElement("div");e.className="hint",e.textContent="No rules yet. Add one below.",s.appendChild(e);return}o.forEach((e,t)=>{let u=document.createElement("div");u.className="row",u.dataset.index=String(t);let n=document.createElement("div");n.className="order";let c=document.createElement("span");c.className="index",c.textContent=String(t+1);let b=document.createElement("button");b.type="button",b.className="icon-btn small",b.textContent="\u25B2",b.dataset.action="up",b.disabled=t===0;let a=document.createElement("button");a.type="button",a.className="icon-btn small",a.textContent="\u25BC",a.dataset.action="down",a.disabled=t===o.length-1,n.append(c,b,a);let g=document.createElement("select");g.dataset.field="type",["channel","videoId","title"].forEach(h=>{let d=document.createElement("option");d.value=h,d.textContent=i[h],e.type===h&&(d.selected=!0),g.appendChild(d)});let m=document.createElement("input");m.type="text",m.value=e.value,m.placeholder="Match text",m.dataset.field="value";let y=document.createElement("input");y.type="number",y.min="0.25",y.max="4",y.step="0.25",y.value=e.speed,y.placeholder="1.5",y.dataset.field="speed";let f=document.createElement("div");f.className="actions-inline";let r=document.createElement("button");r.type="button",r.className="icon-btn",r.textContent="Delete",r.dataset.action="delete",f.append(r),u.append(n,g,m,y,f),s.appendChild(u)})},z=function(e){return e.map(t=>({id:t.id||crypto.randomUUID(),type:t.type,value:String(t.value||"").trim(),speed:String(t.speed||"").trim()})).filter(t=>t.value&&t.speed)},B=function(e,t){if(t<0||t>=o.length)return;let u=[...o],[n]=u.splice(e,1);u.splice(t,0,n),o=u,l()},U=function(e){o=o.filter((t,u)=>u!==e),l()},D=function(e,t,u){o=o.map((n,c)=>c!==e?n:{...n,[t]:u})},p={rules:[]},i={channel:"Channel",title:"Title",videoId:"Video ID"},o=[];s.addEventListener("click",e=>{let t=e.target;if(!(t instanceof HTMLElement))return;let u=t.closest(".row");if(!(u instanceof HTMLElement))return;let n=Number(u.dataset.index);t.dataset.action==="up"&&B(n,n-1),t.dataset.action==="down"&&B(n,n+1),t.dataset.action==="delete"&&U(n)}),s.addEventListener("input",e=>{let t=e.target;if(!(t instanceof HTMLInputElement||t instanceof HTMLSelectElement))return;let u=t.closest(".row");if(!(u instanceof HTMLElement))return;let n=Number(u.dataset.index),c=t.dataset.field;c&&D(n,c,t.value)}),R.addEventListener("click",()=>{let e=v.value.trim(),t=T.value.trim();if(!e||!t){L("Add a match and speed");return}o=[...o,{id:crypto.randomUUID(),type:x.value,value:e,speed:t}],v.value="",T.value="",l()}),M.addEventListener("click",()=>{let e=z(o);chrome.storage.sync.set({rules:e},()=>{o=e,l(),L("Saved")})}),chrome.storage.sync.get(p,e=>{o=e.rules||[],l(),w()}),w()}})();
