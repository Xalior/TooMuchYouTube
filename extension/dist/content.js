(()=>{var w=["youtu.be","youtube-nocookie.com","youtube.ae","youtube.al","youtube.am","youtube.at","youtube.az","youtube.ba","youtube.be","youtube.bg","youtube.bh","youtube.bo","youtube.by","youtube.ca","youtube.cat","youtube.ch","youtube.cl","youtube.co","youtube.co.ae","youtube.co.at","youtube.co.cr","youtube.co.hu","youtube.co.id","youtube.co.il","youtube.co.in","youtube.co.jp","youtube.co.ke","youtube.co.kr","youtube.co.ma","youtube.co.nz","youtube.co.th","youtube.co.tz","youtube.co.ug","youtube.co.uk","youtube.co.ve","youtube.co.za","youtube.co.zw","youtube.com","youtube.com.ar","youtube.com.au","youtube.com.az","youtube.com.bd","youtube.com.bh","youtube.com.bo","youtube.com.br","youtube.com.by","youtube.com.co","youtube.com.do","youtube.com.ec","youtube.com.ee","youtube.com.eg","youtube.com.es","youtube.com.gh","youtube.com.gr","youtube.com.gt","youtube.com.hk","youtube.com.hn","youtube.com.hr","youtube.com.jm","youtube.com.jo","youtube.com.kw","youtube.com.lb","youtube.com.lv","youtube.com.ly","youtube.com.mk","youtube.com.mt","youtube.com.mx","youtube.com.my","youtube.com.ng","youtube.com.ni","youtube.com.om","youtube.com.pa","youtube.com.pe","youtube.com.ph","youtube.com.pk","youtube.com.pt","youtube.com.py","youtube.com.qa","youtube.com.ro","youtube.com.sa","youtube.com.sg","youtube.com.sv","youtube.com.tn","youtube.com.tr","youtube.com.tw","youtube.com.ua","youtube.com.uy","youtube.com.ve","youtube.cr","youtube.cz","youtube.de","youtube.dk","youtube.ee","youtube.es","youtube.fi","youtube.fr","youtube.ge","youtube.gr","youtube.gt","youtube.hk","youtube.hr","youtube.hu","youtube.ie","youtube.in","youtube.iq","youtube.is","youtube.it","youtube.jo","youtube.jp","youtube.kr","youtube.kz","youtube.la","youtube.lk","youtube.lt","youtube.lu","youtube.lv","youtube.ly","youtube.ma","youtube.md","youtube.me","youtube.mk","youtube.mn","youtube.mx","youtube.my","youtube.ng","youtube.ni","youtube.nl","youtube.no","youtube.pa","youtube.pe","youtube.ph","youtube.pk","youtube.pl","youtube.pr","youtube.pt","youtube.qa","youtube.ro","youtube.rs","youtube.ru","youtube.sa","youtube.se","youtube.sg","youtube.si","youtube.sk","youtube.sn","youtube.soy","youtube.sv","youtube.tn","youtube.tv","youtube.ua","youtube.ug","youtube.uy","youtube.vn","youtubeeducation.com","youtubefanfest.com","youtubegaming.com","youtubego.co.id","youtubego.co.in","youtubego.com","youtubego.com.br","youtubego.id","youtubego.in","youtubekids.com","youtubemobilesupport.com","yt.be"],C=new Set(w);function v(e){let t=e.toLowerCase();if(C.has(t))return!0;for(let o of w)if(t.endsWith(`.${o}`))return!0;return!1}var f={rules:[]};function m(e){return e.toLowerCase()}function p(){let e=new URL(window.location.href);if(e.hostname==="youtu.be")return e.pathname.split("/")[1]?.split(/[?&#/]/)[0]||"";let t=e.searchParams.get("v");return t||e.pathname.startsWith("/shorts/")&&e.pathname.split("/shorts/")[1].split(/[?&#/]/)[0]||""}function E(){let e=document.querySelector("h1 yt-formatted-string, h1.title");return e&&e.textContent?e.textContent.trim():document.title.replace(" - YouTube","").trim()}function L(){let e=new Set;document.querySelectorAll("ytd-channel-name a, #text-container.ytd-channel-name, ytd-video-owner-renderer a, ytd-video-owner-renderer #text").forEach(r=>{r&&r.textContent&&e.add(r.textContent.trim())}),document.querySelectorAll("ytd-video-owner-renderer a[href], ytd-channel-name a[href]").forEach(r=>{let a=r.getAttribute("href")||"",b=a.match(/\/(@[^/?#]+)/);b&&e.add(b[1]);let l=a.match(/\/channel\/([^/?#]+)/);l&&e.add(l[1])});let n=document.querySelector('meta[itemprop="author"]');n&&n.getAttribute("content")&&e.add(n.getAttribute("content")?.trim()||"");let u=document.querySelector('meta[itemprop="channelId"]');return u&&u.getAttribute("content")&&e.add(u.getAttribute("content")?.trim()||""),window.ytInitialPlayerResponse?.videoDetails?.author&&e.add(window.ytInitialPlayerResponse.videoDetails.author.trim()),Array.from(e).filter(Boolean)}chrome.runtime.onMessage.addListener((e,t,o)=>{!e||e.type!=="getQuickAddData"||o({videoId:p(),channelCandidates:L(),title:E()})});function S(e,{channels:t,title:o,videoId:n}){if(!e||!e.value)return!1;let u=m(e.value);return e.type==="channel"?t.length>0&&t.some(r=>m(r).includes(u)):e.type==="title"?o&&m(o).includes(u):e.type==="videoId"?n&&e.value.trim()===n:!1}var s=null,c=null,i=null,k=new WeakSet,M=0;function x(){return p()||window.location.href}var V="TMY_PLAYBACK_RATE_SYNC";function H(e){window.postMessage({channel:V,type:"setPlaybackRate",rate:e},"*")}function q(){let e=[],t=document.getElementById("movie_player");t&&typeof t.setPlaybackRate=="function"&&e.push(t);let o=document.querySelector("ytd-player");if(o){if(typeof o.getPlayer=="function"){let u=o.getPlayer();u&&typeof u.setPlaybackRate=="function"&&e.push(u)}let n=o.player_;n&&typeof n.setPlaybackRate=="function"&&e.push(n)}return e}function h(e,t){e.playbackRate!==t&&(M=Date.now(),e.playbackRate=t)}function _(e,t){k.has(e)||(k.add(e),e.addEventListener("ratechange",()=>{!e.isConnected||e.playbackRate===t||Date.now()-M<400||(i=e,y&&(window.clearInterval(y),y=null))}))}var y=null,P=0;function A(e){let n=P+=1,u=0;y&&(window.clearInterval(y),y=null);let r=()=>{if(n!==P)return;u+=1;let a=document.querySelector("video"),b=q();if(i&&i===a){y&&(window.clearInterval(y),y=null);return}H(e),b.forEach(l=>{if(typeof l.setPlaybackRate=="function")try{l.setPlaybackRate(e)}catch{}}),a&&a.playbackRate!==e&&h(a,e),u>=30&&(window.clearInterval(y),y=null)};r(),y=window.setInterval(r,350)}function N(e){if(!e)return!1;let t=Number(e);if(!Number.isFinite(t)||t<=0)return!1;let o=!1,n=Array.from(document.querySelectorAll("video"));return n.length===0||(n.forEach(u=>{if(_(u,t),u.readyState>=1){h(u,t),o=!0;return}let r=()=>{h(u,t)};u.addEventListener("loadedmetadata",r,{once:!0}),u.addEventListener("playing",()=>{A(t)},{once:!0}),o=!0}),A(t),c=n[0]||null),o}var d=null;function g(){d||(d=window.setTimeout(()=>{d=null,I()},150))}function I(){if(!v(window.location.hostname))return;let e=x();if(s===e){let u=document.querySelector("video");if(c&&u&&c===u&&u.isConnected)return;u&&c!==u&&(i=null)}let t=L(),o=E(),n=p();for(let u of f.rules)if(S(u,{channels:t,title:o,videoId:n})){N(u.speed)&&(s=e);return}}function T(){chrome.storage.sync.get(f,e=>{f.rules=e.rules||[],s=null,c=null,i=null,I()})}chrome.storage.onChanged.addListener((e,t)=>{t==="sync"&&e.rules&&T()});window.addEventListener("yt-navigate-finish",()=>{s=null,c=null,i=null,g()});var z=new MutationObserver(()=>{g()});z.observe(document.documentElement,{childList:!0,subtree:!0});T();var R=0,D=window.setInterval(()=>{g(),R+=1,R>=20&&window.clearInterval(D)},500);})();
